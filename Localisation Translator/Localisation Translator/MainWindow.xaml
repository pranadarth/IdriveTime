<Window x:Class="Localisation_Translator.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Localisation_Translator"
        mc:Ignorable="d"
       Title="Resx ⇄ CSV Translator" Height="700" Width="1000" MinWidth="900">
    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>


        <StackPanel Orientation="Horizontal" Grid.Row="0" VerticalAlignment="Top" Margin="0,0,0,8">
            <TextBlock Text="OpenAI API Key:" VerticalAlignment="Center" Margin="0,4,8,0"/>
            <PasswordBox x:Name="ApiKeyBox" Width="360" ToolTip="Paste your OpenAI API key here"/>
            <CheckBox x:Name="UseEnvCheck" Content="Use OPENAI_API_KEY environment variable" Margin="12,0,0,0" VerticalAlignment="Center"/>
            <ComboBox x:Name="ModelCombo" Width="200" Margin="12,0,0,0" VerticalAlignment="Center">
                <ComboBoxItem>gpt-5-mini</ComboBoxItem>
                <ComboBoxItem>gpt-5</ComboBoxItem>
                <ComboBoxItem>gpt-4o-mini</ComboBoxItem>
            </ComboBox>
        </StackPanel>


        <StackPanel Orientation="Horizontal" Grid.Row="1" Margin="0,0,0,8">
            <Button x:Name="BtnLoadCsv" Content="Load CSV" Width="120" Click="BtnLoadCsv_Click" />
            <Button x:Name="BtnLoadResx" Content="Load RESX(s)" Width="120" Margin="8,0,0,0" Click="BtnLoadResx_Click" />


            <TextBlock Text="Output:" Margin="16,6,8,0" VerticalAlignment="Center"/>
            <CheckBox x:Name="OutCsvChk" Content="CSV" IsChecked="True" Margin="0,0,8,0" VerticalAlignment="Center"/>
            <CheckBox x:Name="OutResxChk" Content="RESX" IsChecked="True" Margin="0,0,8,0" VerticalAlignment="Center"/>


            <Button x:Name="BtnStart" Content="Start Translation" Width="140" Margin="16,0,0,0" Click="BtnStart_Click"/>
            <Button x:Name="BtnStop" Content="Stop" Width="80" Margin="8,0,0,0" Click="BtnStop_Click" IsEnabled="False"/>
        </StackPanel>


        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="360" />
                <ColumnDefinition Width="12" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>


            <!-- Left: languages / options -->
            <Border Grid.Column="0" BorderBrush="#DDD" BorderThickness="1" Padding="8" CornerRadius="6">
                <StackPanel>
                    <TextBlock Text="Languages to Translate" FontWeight="Bold" Margin="0,0,0,6" />
                    <ScrollViewer Height="360">
                        <StackPanel x:Name="LanguagesPanel" />
                    </ScrollViewer>


                    <TextBlock Text="Exclude / Preserve (one per line)" FontWeight="Bold" Margin="0,12,0,6" />
                    <TextBox x:Name="ExcludeBox" AcceptsReturn="True" Height="120" TextWrapping="Wrap" />
                </StackPanel>
            </Border>


            <!-- Right: preview table and log -->
            <StackPanel Grid.Column="2">
                <TextBlock Text="Preview (first 200 rows)" FontWeight="Bold" Margin="0,0,0,6" />
                <DataGrid x:Name="PreviewGrid" Height="360" AutoGenerateColumns="True" IsReadOnly="True" />


                <TextBlock Text="Log" FontWeight="Bold" Margin="0,8,0,4" />
                <TextBox x:Name="LogBox" Height="180" IsReadOnly="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto" />
            </StackPanel>
        </Grid>


        <StackPanel Grid.Row="3" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,8,0,0">
            <ProgressBar x:Name="ProgressBar" Width="500" Height="18" Minimum="0" Maximum="100" />
            <TextBlock x:Name="ProgressText" Margin="8,0,0,0" VerticalAlignment="Center"/>
        </StackPanel>
    </Grid>
</Window>