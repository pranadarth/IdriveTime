!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.add_on=t():e.add_on=t()}(this,()=>(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{initializeMainStage:()=>h,setUpSidePanel:()=>l});const n="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};(function(){var e=Object.defineProperty,t=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(n,r){if(r)e:{var o=t;n=n.split(".");for(var i=0;i<n.length-1;i++){var a=n[i];if(!(a in o))break e;o=o[a]}(r=r(i=o[n=n[n.length-1]]))!=i&&null!=r&&e(o,n,{configurable:!0,writable:!0,value:r})}}("Symbol.dispose",function(e){return e||Symbol("Symbol.dispose")});var n,r,o=this||self;function i(e,t){function n(){}n.prototype=t.prototype,e.qa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.oa=function(e,n,r){for(var o=Array(arguments.length-2),i=2;i<arguments.length;i++)o[i-2]=arguments[i];return t.prototype[n].apply(e,o)}}function a(e,t){if(Error.captureStackTrace)Error.captureStackTrace(this,a);else{const e=Error().stack;e&&(this.stack=e)}e&&(this.message=String(e)),void 0!==t&&(this.cause=t)}function s(e){o.setTimeout(()=>{throw e},0)}i(a,Error),a.prototype.name="CustomError";e:{for(var c=["CLOSURE_FLAGS"],l=o,d=0;d<c.length;d++)if(null==(l=l[c[d]])){r=null;break e}r=l}var u,f=r&&r[610401301];n=null!=f&&f;const g=o.navigator;function h(e){return!!n&&!!u&&u.brands.some(({brand:t})=>t&&-1!=t.indexOf(e))}function p(e){var t;return(t=o.navigator)&&(t=t.userAgent)||(t=""),-1!=t.indexOf(e)}function m(){return!!n&&!!u&&u.brands.length>0}function y(){return m()?h("Chromium"):(p("Chrome")||p("CriOS"))&&!(!m()&&p("Edge"))||p("Silk")}function w(e,t){(t=Array.prototype.indexOf.call(e,t,void 0))>=0&&Array.prototype.splice.call(e,t,1)}function v(e){let t="",n=0;const r=e.length-10240;for(;n<r;)t+=String.fromCharCode.apply(null,e.subarray(n,n+=10240));return t+=String.fromCharCode.apply(null,n?e.subarray(n):e),btoa(t)}u=g&&g.userAgentData||null,!p("Android")||y(),y(),p("Safari")&&(y()||!m()&&p("Coast")||!m()&&p("Opera")||!m()&&p("Edge")||(m()?h("Microsoft Edge"):p("Edg/"))||m()&&h("Opera"));const b=/[-_.]/g,S={"-":"+",_:"/",".":"="};function x(e){return S[e]||""}function E(e){return null!=e&&e instanceof Uint8Array}var I={};function A(){return P||(P=new T(null,I))}var T=class{constructor(e,t){if(k(t),this.g=e,null!=e&&0===e.length)throw Error("ByteString should be constructed with non-empty values")}};let P,N;function k(e){if(e!==I)throw Error("illegal external caller")}function C(e,t){e.__closure__error__context__984382||(e.__closure__error__context__984382={}),e.__closure__error__context__984382.severity=t}function B(){const e=Error();C(e,"incident"),s(e)}function O(e){return C(e=Error(e),"warning"),e}function _(){return"function"==typeof BigInt}function M(e){return Array.prototype.slice.call(e)}function j(e,t){return t&&Symbol.for&&e?Symbol.for(e):null!=e?Symbol(e):Symbol()}var U=j("jas",!0);j();var D=j(),L=j();function R(e,t){t[U]=-30975&e}function F(e,t){t[U]=-30941&e|34}j(),j();var z,$={},G={};function H(e){return!(!e||"object"!=typeof e||e.g!==G)}function J(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)&&e.constructor===Object}function Y(e,t){if(null!=e)if("string"==typeof e)e=e?new T(e,I):A();else if(e.constructor!==T)if(E(e))e=e.length?new T(new Uint8Array(e),I):A();else{if(!t)throw Error();e=void 0}return e}function W(e){return!(!Array.isArray(e)||e.length||!(1&e[U]))}const K=[];function V(e){if(2&e)throw Error()}K[U]=55,z=Object.freeze(K);var q=Object.freeze({});function X(e){return e.pa=!0,e}var Z=X(e=>"number"==typeof e),Q=X(e=>"string"==typeof e),ee=X(e=>"boolean"==typeof e),te="function"==typeof o.BigInt&&"bigint"==typeof o.BigInt(0),ne=X(e=>te?e>=oe&&e<=ae:"-"===e[0]?se(e,re):se(e,ie));const re=Number.MIN_SAFE_INTEGER.toString(),oe=te?BigInt(Number.MIN_SAFE_INTEGER):void 0,ie=Number.MAX_SAFE_INTEGER.toString(),ae=te?BigInt(Number.MAX_SAFE_INTEGER):void 0;function se(e,t){if(e.length>t.length)return!1;if(e.length<t.length||e===t)return!0;for(let n=0;n<e.length;n++){const r=e[n],o=t[n];if(r>o)return!1;if(r<o)return!0}}let ce=0,le=0;function de(e){const t=e>>>0;ce=t,le=(e-t)/4294967296>>>0}function ue(e){if(e<0){de(-e);const[t,n]=he(ce,le);ce=t>>>0,le=n>>>0}else de(e)}function fe(e,t){if(e>>>=0,(t>>>=0)<=2097151)var n=""+(4294967296*t+e);else _()?n=""+(BigInt(t)<<BigInt(32)|BigInt(e)):(e=(16777215&e)+6777216*(n=16777215&(e>>>24|t<<8))+6710656*(t=t>>16&65535),n+=8147497*t,t*=2,e>=1e7&&(n+=e/1e7>>>0,e%=1e7),n>=1e7&&(t+=n/1e7>>>0,n%=1e7),n=t+ge(n)+ge(e));return n}function ge(e){return e=String(e),"0000000".slice(e.length)+e}function he(e,t){return t=~t,e?e=1+~e:t+=1,[e,t]}function pe(e){return null==e||"boolean"==typeof e?e:"number"==typeof e?!!e:void 0}const me=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;function ye(e){const t=typeof e;switch(t){case"bigint":return!0;case"number":return Number.isFinite(e)}return"string"===t&&me.test(e)}function we(e){if(null!=e){if(!Number.isFinite(e))throw O("enum");e|=0}return e}function ve(e){if(null!=e){if("string"==typeof e){if(!e)return;e=+e}"number"==typeof e&&Number.isFinite(e)}}function be(e){if(null!=e)e:{if(!ye(e))throw O("int64");switch(typeof e){case"string":e=xe(e);break e;case"bigint":var t=e=BigInt.asIntN(64,e);if(Q(t)){if(!/^\s*(?:-?[1-9]\d*|0)?\s*$/.test(t))throw Error(String(t))}else if(Z(t)&&!Number.isSafeInteger(t))throw Error(String(t));e=te?BigInt(e):ee(e)?e?"1":"0":Q(e)?e.trim()||"0":String(e);break e;default:e=Se(e)}}return e}function Se(e){if(e=Math.trunc(e),!Number.isSafeInteger(e)){ue(e);var t=ce,n=le;(e=2147483648&n)&&(n=~n>>>0,0==(t=1+~t>>>0)&&(n=n+1>>>0));const r=4294967296*n+(t>>>0);e="number"==typeof(t=Number.isSafeInteger(r)?r:fe(t,n))?e?-t:t:e?"-"+t:t}return e}function xe(e){var t=Math.trunc(Number(e));if(Number.isSafeInteger(t))return String(t);if(-1!==(t=e.indexOf("."))&&(e=e.substring(0,t)),!("-"===e[0]?e.length<20||20===e.length&&Number(e.substring(0,7))>-922337:e.length<19||19===e.length&&Number(e.substring(0,6))<922337)){if(e.length<16)ue(Number(e));else if(_())e=BigInt(e),ce=Number(e&BigInt(4294967295))>>>0,le=Number(e>>BigInt(32)&BigInt(4294967295));else{t=+("-"===e[0]),le=ce=0;const n=e.length;for(let r=t,o=(n-t)%6+t;o<=n;r=o,o+=6){const t=Number(e.slice(r,o));le*=1e6,ce=1e6*ce+t,ce>=4294967296&&(le+=Math.trunc(ce/4294967296),le>>>=0,ce>>>=0)}if(t){const[e,t]=he(ce,le);ce=e,le=t}}if(e=ce,2147483648&(t=le))if(_())e=""+(BigInt(0|t)<<BigInt(32)|BigInt(e>>>0));else{const[n,r]=he(e,t);e="-"+fe(n,r)}else e=fe(e,t)}return e}function Ee(e){if(null!=e&&"string"!=typeof e)throw Error();return e}function Ie(e,t,n){if(null!=e&&"object"==typeof e&&e.H===$)return e;if(Array.isArray(e)){var r=0|e[U],o=r;return 0===o&&(o|=32&n),(o|=2&n)!==r&&(e[U]=o),new t(e)}}let Ae,Te,Pe,Ne,ke,Ce;function Be(e){let t;return null==(t=Ae)?void 0:t.get(e)}function Oe(e){try{return-1!==e.toString().indexOf("[native code]")?e:null}catch{return null}}function _e(e,t){return Me(t)}function Me(e){switch(typeof e){case"number":return isFinite(e)?e:String(e);case"bigint":return ne(e)?Number(e):String(e);case"boolean":return e?1:0;case"object":if(e)if(Array.isArray(e)){if(W(e))return}else{if(E(e))return v(e);if(e instanceof T){const t=e.g;return null==t?"":"string"==typeof t?t:e.g=v(t)}}}return e}function je(e,t,n,r,o){if(null!=e){if(Array.isArray(e))e=W(e)?void 0:o&&2&e[U]?e:Ue(e,t,n,void 0!==r,o);else if(J(e)){const i={};for(let a in e)i[a]=je(e[a],t,n,r,o);e=i}else e=t(e,r);return e}}function Ue(e,t,n,r,o){const i=r||n?0|e[U]:0;r=r?!!(32&i):void 0,e=M(e);for(let i=0;i<e.length;i++)e[i]=je(e[i],t,n,r,o);return n&&n(i,e),e}function De(e){return e.H===$?e.toJSON():Me(e)}function Le(e,t,n=F){if(null!=e){if(e instanceof Uint8Array)return t?e:new Uint8Array(e);if(Array.isArray(e)){var r=0|e[U];return 2&r?e:(t&&(t=0===r||!!(32&r)&&!(64&r||!(16&r))),t?(e[U]=-12293&r|34,e):Ue(e,Le,4&r?F:n,!0,!0))}return e.H===$&&(e=2&(r=(n=e.m)[U])?e:new e.constructor(Re(n,r,!0))),e}}function Re(e,t,n){const r=n||2&t?F:R,o=!!(32&t);return e=function(e,t,n){var r=(e=M(e)).length;const o=256&t?e[r-1]:void 0;for(r+=o?-1:0,t=512&t?1:0;t<r;t++)e[t]=n(e[t]);if(o){t=e[t]={};for(const e in o)t[e]=n(o[e])}return e}(e,t,e=>Le(e,o,r)),e[U]=32|e[U]|(n?2:0),e}function Fe(e){const t=e.m,n=t[U];return 2&n?new e.constructor(Re(t,n,!1)):e}function ze(e,t){return Ge(e=e.m,e[U],t)}function $e(e,t,n,r){if(!((t=r+(+!!(512&t)-1))<0||t>=e.length||t>=n))return e[t]}function Ge(e,t,n,r){if(-1===n)return null;const o=t>>15&1023||536870912;if(!(n>=o)){var i,a=e.length;return r&&256&t&&null!=(r=e[a-1][n])?($e(e,t,o,n)&&null!=D&&(e=null!=(i=N)?i:N={},(i=e[D]||0)>=4||(e[D]=i+1,B())),r):$e(e,t,o,n)}return 256&t?e[e.length-1][n]:void 0}function He(e,t,n){const r=e.m;let o=r[U];return V(o),Je(r,o,t,n),e}function Je(e,t,n,r){const o=t>>15&1023||536870912;if(n>=o){let i,a=t;if(256&t)i=e[e.length-1];else{if(null==r)return a;i=e[o+(+!!(512&t)-1)]={},a|=256}return i[n]=r,n<o&&(e[n+(+!!(512&t)-1)]=void 0),a!==t&&(e[U]=a),a}return e[n+(+!!(512&t)-1)]=r,256&t&&n in(e=e[e.length-1])&&delete e[n],t}function Ye(e,t,n,r){return void 0!==Ze(e,t,n=Ve(e,r)===n?n:-1)}function We(e){return!!(2&e)&&!!(4&e)||!!(2048&e)}function Ke(e,t,n,r){const o=e.m;let i=o[U];return V(i),Je(o,i,t,("0"===r?0===Number(n):n===r)?void 0:n),e}function Ve(e,t){return Xe(qe(e=e.m),e,e[U],t)}function qe(e){let t;return null!=(t=e[L])?t:e[L]=new Map}function Xe(e,t,n,r){let o=e.get(r);if(null!=o)return o;o=0;for(let e=0;e<r.length;e++){const i=r[e];null!=Ge(t,n,i)&&(0!==o&&(n=Je(t,n,o)),o=i)}return e.set(r,o),o}function Ze(e,t,n,r){let o=(e=e.m)[U];return(t=Ie(r=Ge(e,o,n,r),t,o))!==r&&null!=t&&Je(e,o,n,t),t}function Qe(e,t,n){if(null==(t=Ze(e,t,n,!1)))return t;let r=(e=e.m)[U];if(!(2&r)){const o=Fe(t);o!==t&&Je(e,r,n,t=o)}return t}function et(e,t,n){return null==n&&(n=void 0),He(e,t,n)}function tt(e,t,n,r){null==r&&(r=void 0);e:{const a=e.m;var o=a[U];if(V(o),null==r){var i=qe(a);if(Xe(i,a,o,n)!==t)break e;i.set(n,0)}else{const e=qe(i=a),r=Xe(e,i,o,n);r!==t&&(r&&(o=Je(i,o,r)),e.set(n,t))}Je(a,o,t,r)}return e}function nt(e,t){const n=e.m;let r=n[U];if(V(r),null==t)return Je(n,r,1),e;var o,i=t;t=(null==(o=Te)?void 0:o.get(i))||i,o=i=0|t[U];const a=We(i),s=a||Object.isFrozen(t);let c=!0,l=!0;for(let e=0;e<t.length;e++){var d=t[e];a||(d=!!(2&d.m[U]),c&&(c=!d),l&&(l=d))}return a||(i=c?13:5,i=l?16|i:-17&i),s&&i===o||(t=M(t),o=0,i=ot(i=rt(i,r),r,!0)),i!==o&&(t[U]=i),Je(n,r,1,t),e}function rt(e,t){return-2049&(2&t?2|e:-3&e)|32}function ot(e,t,n){return 32&t&&n||(e&=-33),e}function it(e,t){return null!=e?e:t}function at(e){return null!=(e=ze(e,1))&&("bigint"==typeof e?ne(e)?e=Number(e):(e=BigInt.asIntN(64,e),e=ne(e)?Number(e):String(e)):e=ye(e)?"number"==typeof e?Se(e):xe(e):void 0),it(e,0)}function st(e,t){return it(null==(e=ze(e,t))||"string"==typeof e?e:void 0,"")}function ct(e,t){return it(e=null==(e=ze(e,t))?e:Number.isFinite(e)?0|e:void 0,0)}function lt(e,t,n,r){return Qe(e,t,n=Ve(e,r)===n?n:-1)}function dt(e){try{return Ce=!0,JSON.stringify(ft(e),_e)}finally{Ce=!1}}var ut=class{constructor(e){e:{var t=null!=t?t:0;if(null==e){var n=96;e=[]}else{if(!Array.isArray(e))throw Error("narr");if(2048&(n=0|e[U]))throw Error("farr");if(64&n)break e;1===t||2===t||(n|=64);var r=(t=e).length;if(r&&J(t[--r])){if((t=r-(+!!(512&(n|=256))-1))>=1024)throw Error("pvtlmt");n=-33521665&n|(1023&t)<<15}}e[U]=n}this.m=e}toJSON(){return ft(this)}};function ft(e){e=e.m,e=Ce?e:Ue(e,De,void 0,void 0,!1);{var t=!Ce;let l=e.length;if(l){var n=e[l-1],r=J(n);r?l--:n=void 0;var o=e;if(r){e:{var i,a=n,s=!1;if(a)for(let e in a)if(isNaN(+e)){let t;(null!=(t=i)?t:i={})[e]=a[e]}else if(r=a[e],Array.isArray(r)&&(W(r)||H(r)&&0===r.size)&&(r=null),null==r&&(s=!0),null!=r){let t;(null!=(t=i)?t:i={})[e]=r}if(s||(i=a),i)for(let e in i){s=i;break e}s=null}a=null==s?null!=n:s!==n}for(;l>0&&(null==(i=o[l-1])||W(i)||H(i)&&0===i.size);l--)var c=!0;(o!==e||a||c)&&(t?(c||a||s)&&(o.length=l):o=Array.prototype.slice.call(o,0,l),s&&o.push(s)),c=o}else c=e}return c}function gt(e){return t=>{if(null==t||""==t)t=new e;else{if(t=JSON.parse(t),!Array.isArray(t))throw Error("dnarr");t[U]|=32,t=new e(t)}return t}}ut.prototype.H=$,ut.prototype.toString=function(){try{return Ce=!0,ft(this).toString()}finally{Ce=!1}};var ht,pt=(ht=class extends ut{},e=>{if(e=JSON.parse(e),!Array.isArray(e)){var t=typeof e;throw Error("Expected jspb data to be an array, got "+("object"!=t?t:e?Array.isArray(e)?"array":t:"null")+": "+e)}return e[U]|=34,new ht(e)}),mt=class extends ut{};function yt(e){return wt(e,e.index)>=e.g&&(e.h[e.index]=Date.now(),e.index=(e.index+1)%1,!0)}function wt(e,t){let n;return Date.now()-(null!=(n=e.h[t])?n:-1*e.g)}var vt=class{constructor(e){this.g=e,this.h=[],this.index=0}},bt=class extends ut{},St=[2,3],xt=class extends ut{},Et=class extends Error{constructor({errorType:e,message:t,i:n}){super(`Meet Add-on SDK error: ${t}${n?` - ${n}`:""}`),this.errorType=e}},It={errorType:"InternalError",message:"An unexpected error has occurred.",i:"No further information is available."},At={errorType:"MissingUrlParameter",message:"Missing required Meet SDK URL parameter",i:"This parameter is automatically appended by Meet to the iframe URL. Ensure that your infrastructure does not strip URL parameters (e.g. as part of a redirect)."},Tt={errorType:"NeedsMainStageContext",message:"This method can only be invoked if the addon is running in the main stage.",i:"Use getFrameType to check whether the addon is running in the main stage before invoking this method."},Pt={errorType:"NeedsSidePanelContext",message:"This method can only be invoked if the addon is running in the side panel.",i:"Use getFrameType to check whether the addon is running in the side panel before invoking this method."},Nt={errorType:"NotSupportedInStandalone",message:"This method is not supported in standalone mode.",i:"Do not call this method in standalone mode."},kt={errorType:"InternalError",message:"The frame type URL parameter is set to an unexpected value.",i:"This parameter is automatically appended by Meet to the iframe URL. Ensure that your infrastructure does not modify URL parameters (e.g. as part of a redirect)."},Ct={errorType:"InvalidCloudProjectNumber",message:"Cloud Project Number provided by meet does not match the one passed in by the SDK. Ensure that the correct Cloud Project Number is passed to the SDK as a string.",i:"This parameter is automatically appended by Meet to the iframe URL. Ensure that your infrastructure does not modify URL parameters (e.g. as part of a redirect) and ensure that the correct Cloud Project Number was passed into the SDK as a string."},Bt={errorType:"DestinationNotReady",message:"The recipient frame is not connected via the addon SDK and cannot receive the notification.",i:"Make sure the destination frame has connected before sending messages to it."},Ot={errorType:"InvalidActivityStartingState",message:"Origin of the ActivityStartingState iframeURLs does not match the origin of the URLs provided in the Add-on manifest.",i:"Ensure that the ActivityStartingState iframeURL origins match the origins of the URLs provided in the Add-on manifest."},_t={errorType:"ActivityStartingStateMissingAttributes",message:"The supplied ActivityStartingState object does not contain any recognized attributes.",i:"Ensure that the ActivityStartingState object contains at least one of the following attributes: mainStageUrl, sidePanelUrl, additionalData."},Mt={errorType:"ActivityStartingStateUnrecognizedAttributes",message:"The supplied ActivityStartingState object contains attributes that are not recognized.",i:"Ensure that the ActivityStartingState object has only the following attributes: mainStageUrl, sidePanelUrl, additionalData."},jt={errorType:"AddonStartingStateMissingAttributes",message:"The supplied AddonStartingState object does not contain any recognized attributes.",i:"Ensure that the AddonStartingState object contains at least one of the following attributes: sidePanelUrl, additionalData."},Ut={errorType:"AddonStartingStateUnrecognizedAttributes",message:"The supplied AddonStartingState object contains attributes that are not recognized.",i:"Ensure that the AddonStartingState object has only the following attributes: sidePanelUrl, additionalData."},Dt=e=>({errorType:"ArgumentNullError",message:`The argument supplied for '${e}' was 'null' but a value was expected.`,i:"Ensure you are passing a value of the expected type for the argument."}),Lt=(e,t,n)=>({errorType:"ArgumentTypeError",message:`The type '${t}' of argument supplied for '${e}' did not match the expected type '${n}'.`,i:"Ensure the type of the argument provided matches the expected type."}),Rt={errorType:"ActivityIsOngoing",message:"Operation cannot be performed while an activity is ongoing.",i:"Ensure that no activity is ongoing."},Ft={errorType:"InternalError",message:"Frame message missing required Meet SDK command.",i:"Send one of the available commands in the frame message."},zt={errorType:"NoActivityFound",message:"No activity found.",i:"Ensure that the activity is started before performing this operation."},$t={errorType:"RequiresEapEnrollment",message:"This feature is only available to early access partners.",i:"Meet add-on early access enrollment is currently closed."},Gt={errorType:"UserNotInitiator",message:"Operation cannot be performed because the user is not the initiator of the current activity.",i:"Ensure that the user is the initiator of the current activity or that the activity has ended."},Ht={errorType:"SizeLimitExceededActivityStartingState",message:"The size of the activityStartingState URLs and/or its data exceed the limits allowed.",i:"Ensure that the activityStartingState URL size is less than 512 characters and the additional data size is less than 4096 characters."},Jt={errorType:"SizeLimitExceededFrameToFrameMessage",message:"The size of the frame to frame message exceeds the limits allowed.",i:"Ensure that the frame to frame message size is less than 1,000,000 characters."},Yt={errorType:"AddonSessionAlreadyCreated",message:"The addon session has already been created.",i:"Only instantiate the AddonSession once."},Wt={errorType:"UserCancelled",message:"The user cancelled starting an activity.",i:"The user needs to click continue to start the activity."},Kt={errorType:"NotSupportedInMeetCall",message:"This method is not supported during a Meet call.",i:"Do not call this method during a Meet call."},Vt={errorType:"InvalidAddonStartingState",message:"Origin of the AddonStartingState iframeURLs does not match the origin of the URLs provided in the Add-on manifest.",i:"Ensure that the AddonStartingState iframeURL origins match the origins of the URLs provided in the Add-on manifest."},qt={errorType:"SizeLimitExceededAddonStartingState",message:"The size of the AddonStartingState URLs and/or its data exceed the limits allowed.",i:"Ensure that the AddonStartingState URL size is less than 512 characters and the additional data size is less than 4096 characters."},Xt={errorType:"MeetingPolicyPreventsStartingActivity",message:"A meeting policy (such as using host control settings) prevents the user from starting the activity.",i:"Have a meeting host or administrator modify the necessary settings to allow the current user to start the activity."};function Zt({errorType:e,message:t,i:n},r=""){throw new Et({errorType:e,message:r?`${t} ${r}`:t,i:n})}function Qt(e,t){Zt({...At,message:`${At.message}: ${e}. In URL ${t}`})}function en(e){return Ke(new rn,1,we(e),0)}function tn(e,t){return Ke(e,2,Ee(t),"")}function nn(e,t){return Ke(e,3,Ee(t),"")}var rn=class extends ut{getFrameType(){return ct(this,1)}};function on(e){var t;t=void 0===q?2:4;var n=e.m[U],r=n,o=!(2&n),i=rn;t=(n=!!(2&r))?1:t,o&&(o=!n),n=Ge(e=e.m,r,1);var a=0|(n=Array.isArray(n)?n:z)[U],s=!!(4&a);if(!s){var c=a;0===c&&(c=rt(c,r)),a=n;var l=r;const e=!!(2&(c|=1));e&&(l|=2);let t=!e,o=!0,s=0,d=0;for(;s<a.length;s++){const n=Ie(a[s],i,l);if(n instanceof i){if(!e){const e=!!(2&n.m[U]);t&&(t=!e),o&&(o=e)}a[d++]=n}}d<s&&(a.length=d),c|=4,c=o?16|c:-17&c,c=t?8|c:-9&c,a[U]=c,e&&Object.freeze(a),a=c}if(o&&!(8&a||!n.length&&(1===t||4===t&&32&a))){for(We(a)&&(n=M(n),a=rt(a,r),r=Je(e,r,1,n)),o=n,i=a,a=0;a<o.length;a++)(c=o[a])!==(l=Fe(c))&&(o[a]=l);i|=8,i=o.length?-17&i:16|i,a=o[U]=i}let d;if(1===t||4===t&&32&a){if(!We(a)){r=a;var u=!!(32&a);(a|=!n.length||16&a&&(!s||u)?2:2048)!==r&&(n[U]=a),Object.freeze(n)}}else s=5===t&&(!!(32&a)||We(a)||!!Be(n)),(2===t||s)&&We(a)&&(n=M(n),a=ot(a=rt(a,r),r,!1),n[U]=a,r=Je(e,r,1,n)),We(a)||(e=a,(a=ot(a,r,!1))!==e&&(n[U]=a)),s?d=function(e){var t;return void 0===Pe&&(Pe="function"==typeof Proxy?Oe(Proxy):null),(t=!Pe)||(void 0===Ne&&(Ne="function"==typeof WeakMap?Oe(WeakMap):null),t=!Ne),t?e:(t=Be(e))?t:Math.random()>.01?e:(function(e){if(void 0===ke){const e=new Pe([],{});ke=1===Array.prototype.concat.call([],e).length}ke&&"function"==typeof Symbol&&Symbol.isConcatSpreadable&&(e[Symbol.isConcatSpreadable]=!0)}(e),function(e,t){(Ae||(Ae=new Ne)).set(e,t),(Te||(Te=new Ne)).set(t,e)}(e,t=new Pe(e,{set:(e,t,n)=>(B(),e[t]=n,!0)})),t)}(n):2===t&&(null==(u=Ae)||u.delete(n));return d||n}function an(e){return nt(new sn,e)}var sn=class extends ut{},cn=class extends ut{};function ln(e){return Ke(new dn,1,we(e),0)}var dn=class extends ut{},un=class extends ut{},fn=class extends ut{},gn=class extends ut{},hn=class extends ut{getMeetingInfo(){return lt(this,gn,3,pn)}getMeetPlatformInfo(){return lt(this,fn,4,pn)}},pn=[2,3,4,5],mn=class extends ut{},yn=[1,4,5,6,7,8,9,10,11,12,13,14,15,16,17],wn=class extends ut{},vn=class extends ut{},bn=new Map([[2,"MAIN_STAGE"],[1,"SIDE_PANEL"]]),Sn=new Map([[0,"UNKNOWN"],[1,"OPEN_ADDON"],[2,"START_ACTIVITY"],[3,"JOIN_ACTIVITY"]]);function xn(e){e&&"function"==typeof e.dispose&&e.dispose()}function En(){this.s=this.s,this.g=this.g}function In(e,t){e.s?t():(e.g||(e.g=[]),e.g.push(t))}function An({J:e,R:t}){if(null===e)throw new Et(Dt("activityStartingState"));if(t||void 0!==e){if("object"!=typeof e)throw new Et(Lt("activityStartingState",typeof e,"object"+(t?"":" | undefined")));if(void 0!==e.mainStageUrl&&"string"!=typeof e.mainStageUrl)throw new Et(Lt("mainStageUrl",typeof e.mainStageUrl,"string | undefined"));if(void 0!==e.sidePanelUrl&&"string"!=typeof e.sidePanelUrl)throw new Et(Lt("sidePanelUrl",typeof e.sidePanelUrl,"string | undefined"));if(void 0!==e.additionalData&&"string"!=typeof e.additionalData)throw new Et(Lt("additionalData",typeof e.additionalData,"string | undefined"));if(Object.keys(e).length!==+!!e.mainStageUrl+ +!!e.sidePanelUrl+ +!!e.additionalData)throw new Et(Mt);if(0===Object.keys(e).length)throw new Et(_t)}}function Tn(e){const t=[];return t.push(nn(tn(en(2),e.mainStageUrl),e.additionalData)),t.push(nn(tn(en(1),e.sidePanelUrl),e.additionalData)),t}En.prototype.s=!1,En.prototype.dispose=function(){this.s||(this.s=!0,this.G())},En.prototype[Symbol.dispose]=function(){this.dispose()},En.prototype.G=function(){if(this.g)for(;this.g.length;)this.g.shift()()};var Pn=class extends En{constructor(e){super(),this.context=e,this.h={},Br(this.context.g.U,e=>{if(7===Ve(e.content,yn)){const n=this.h.frameToFrameMessage;if(e=lt(e.content,un,7,yn),n&&e){var t=ct(e,1);if(void 0===(t=bn.get(t)))throw Error("Unknown frame type.");n({originator:t,payload:st(e,2)})}}})}async getMeetingInfo(){const e=await Vr(this.context.g,ln(2));return{meetingId:st(e.getMeetingInfo(),1),meetingCode:st(e.getMeetingInfo(),2)}}async getFrameOpenReason(){let e;const t=null!=(e=this.context.h.ca)?e:0;let n;return null!=(n=Sn.get(t))?n:"UNKNOWN"}async getActivityStartingState(){var e=lt(await Vr(this.context.g,ln(1)),sn,2,pn);const t=null==e?void 0:on(e).find(e=>2===e.getFrameType());return e=null==e?void 0:on(e).find(e=>1===e.getFrameType()),{mainStageUrl:(null==t?void 0:st(t,2))||void 0,sidePanelUrl:(null==e?void 0:st(e,2))||void 0,additionalData:(null==e?void 0:st(e,3))||void 0}}async setActivityStartingState(e){An({J:e,R:!0});var t=Tn(e);e=qr;var n=this.context.g,r=new wn;r=et(r,1,t=an(t)),await e(n,r)}on(e,t){this.h[e]=t}async getMeetPlatformInfo(){return{isMeetHardware:it(pe(ze((await Vr(this.context.g,ln(3))).getMeetPlatformInfo(),1)),!1)}}async closeAddon(){await async function(e){var t=Zr,n=new zn,r=new Cn;n=tt(n,11,$n,r),await t(e,Lr(n))}(this.context.g)}async startActivity(e){An({J:e,R:!1});const t=new vn;e&&et(t,1,e=an(e=Tn(e))),await async function(e,t){var n=Zr;t=tt(new zn,14,$n,t),await n(e,Lr(t))}(this.context.g,t)}async endActivity(e){var t=Xr,n=this.context.g;e=Ke(new cn,1,we("aab61ee0-51b4-475d-aa4d-849f2498640d"===e?999:0),0),await t(n,e)}},Nn=gt(class extends ut{getFrameOpenReason(){return ct(this,5)}});function kn(){var e=window.location.href,t=window.location.href,n=new URL(t).searchParams.get("meet_sdk");if(n?t=Nn(atob(n)):(Qt("meet_sdk",t),t=void 0),(n=st(t,1))||Qt("meet_addon_frame_type",e),2!==(n=Number(n))&&1!==n)throw new Et(kt);const r=st(t,2);r||Qt("meet_control_channel_name",e);const o=st(t,4);var i;return o||Qt("addon_cloud_project_number",e),{ca:e=null!=(i=t.getFrameOpenReason())?i:0,frameType:n,ba:r,cloudProjectNumber:o,S:i=st(t,3)||"https://meet.google.com"}}var Cn=class extends ut{},Bn=class extends ut{},On=class extends ut{},_n=[1,2],Mn=class extends ut{},jn=class extends ut{},Un=class extends ut{},Dn=class extends ut{},Ln=class extends ut{},Rn=class extends ut{setAddonStartingState(e){return et(this,1,e)}},Fn=class extends ut{},zn=class extends ut{},$n=[1,2,5,6,7,8,9,10,11,13,14,15,16],Gn=class extends ut{},Hn=gt(Gn),Jn=[1,2];class Yn{constructor(e,t){this.data=e,this.channel=t}}var Wn=Promise;function Kn(e){const t=new MessageChannel;return Xn(t.port1,e),t}function Vn(e,t){return Xn(e,t),new qn(e)}class qn{constructor(e){this.g=e}send(e,t,n=[]){t=Kn(t),this.g.postMessage(e,[t.port2].concat(n))}C(e,t){return new Wn(n=>{this.send(e,n,t)})}}function Xn(e,t){t&&(e.onmessage=e=>{var n=e.data;e=Vn(e.ports[0]),t(new Yn(n,e))})}var Zn="undefined"!=typeof AsyncContext&&"function"==typeof AsyncContext.Snapshot?e=>e&&AsyncContext.Snapshot.wrap(e):e=>e;function Qn(e,t){e.l(t),e.h<100&&(e.h++,t.next=e.g,e.g=t)}class er{constructor(e,t){this.j=e,this.l=t,this.h=0,this.g=null}get(){let e;return this.h>0?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.j(),e}}function tr(){var e=ar;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var nr=new er(()=>new rr,e=>e.reset());class rr{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let or,ir=!1,ar=new class{constructor(){this.h=this.g=null}add(e,t){const n=nr.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},sr=(e,t)=>{or||cr(),ir||(or(),ir=!0),ar.add(e,t)},cr=()=>{const e=Promise.resolve(void 0);or=()=>{e.then(lr)}};function lr(){let e;for(;e=tr();){try{e.h.call(e.g)}catch(e){s(e)}Qn(nr,e)}ir=!1}function dr(){}function ur(e){if(this.g=0,this.T=void 0,this.l=this.h=this.j=null,this.v=this.B=!1,e!=dr)try{const t=this;e.call(void 0,function(e){wr(t,2,e)},function(e){wr(t,3,e)})}catch(e){wr(this,3,e)}}function fr(){this.next=this.context=this.h=this.l=this.g=null,this.j=!1}fr.prototype.reset=function(){this.context=this.h=this.l=this.g=null,this.j=!1};var gr=new er(function(){return new fr},function(e){e.reset()});function hr(e,t,n){const r=gr.get();return r.l=e,r.h=t,r.context=n,r}function pr(e,t){(t=hr(t=Zn(t),t)).j=!0,yr(e,t)}function mr(e,t){if(0==e.g)if(e.j){var n=e.j;if(n.h){var r=0,o=null,i=null;for(let t=n.h;t&&(t.j||(r++,t.g==e&&(o=t),!(o&&r>1)));t=t.next)o||(i=t);o&&(0==n.g&&1==r?mr(n,t):(i?((r=i).next==n.l&&(n.l=r),r.next=r.next.next):br(n),Sr(n,o,3,t)))}e.j=null}else wr(e,3,t)}function yr(e,t){e.h||2!=e.g&&3!=e.g||vr(e),e.l?e.l.next=t:e.h=t,e.l=t}function wr(e,t,n){if(0==e.g){e===n&&(t=3,n=new TypeError("Promise cannot resolve to itself")),e.g=1;e:{var r=n,o=e.ma,i=e.na;if(r instanceof ur){yr(r,hr(o||dr,i||null,e));var a=!0}else{if(r)try{var s=!!r.$goog_Thenable}catch(e){s=!1}else s=!1;if(s)r.then(o,i,e),a=!0;else{if("object"==(s=typeof r)&&null!=r||"function"==s)try{const t=r.then;if("function"==typeof t){!function(e,t,n,r,o){function i(e){a||(a=!0,r.call(o,e))}let a=!1;try{t.call(e,function(e){a||(a=!0,n.call(o,e))},i)}catch(e){i(e)}}(r,t,o,i,e),a=!0;break e}}catch(t){i.call(e,t),a=!0;break e}a=!1}}}a||(e.T=n,e.g=t,e.j=null,vr(e),3!=t||n instanceof Ir||function(e,t){e.v=!0,sr(function(){e.v&&Er.call(null,t)})}(e,n))}}function vr(e){e.B||(e.B=!0,sr(e.la,e))}function br(e){let t=null;return e.h&&(t=e.h,e.h=t.next,t.next=null),e.h||(e.l=null),t}function Sr(e,t,n,r){if(3==n&&t.h&&!t.j)for(;e&&e.v;e=e.j)e.v=!1;if(t.g)t.g.j=null,xr(t,n,r);else try{t.j?t.l.call(t.context):xr(t,n,r)}catch(e){Er.call(null,e)}Qn(gr,t)}function xr(e,t,n){2==t?e.l.call(e.context,n):e.h&&e.h.call(e.context,n)}ur.prototype.then=function(e,t,n){return function(e,t,n,r){const o=hr(null,null,null);return o.g=new ur(function(e,i){o.l=t?function(n){try{const o=t.call(r,n);e(o)}catch(e){i(e)}}:e,o.h=n?function(t){try{const o=n.call(r,t);void 0===o&&t instanceof Ir?i(t):e(o)}catch(e){i(e)}}:i}),o.g.j=e,yr(e,o),o.g}(this,Zn("function"==typeof e?e:null),Zn("function"==typeof t?t:null),n)},ur.prototype.$goog_Thenable=!0,ur.prototype.cancel=function(e){if(0==this.g){const t=new Ir(e);sr(function(){mr(this,t)},this)}},ur.prototype.ma=function(e){this.g=0,wr(this,2,e)},ur.prototype.na=function(e){this.g=0,wr(this,3,e)},ur.prototype.la=function(){let e;for(;e=br(this);)Sr(this,e,this.g,this.T);this.B=!1};var Er=s;function Ir(e){a.call(this,e)}function Ar(e,t,n){this.promise=e,this.resolve=t,this.reject=n}i(Ir,a),Ir.prototype.name="cancel";let Tr=1,Pr=new WeakMap;function Nr(e,t,n){var r=Cr;e.h.has(t),r(t,n)}var kr=class extends En{constructor(){super(),this.h=new Set}signal(){const e=new Or;return this.h.add(e),In(this,function(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}(xn,e)),e}};function Cr(e,t){return new Promise(n=>{jr(()=>{e.L&&(e.ea=t,e.P=!0);for(const{I:n,slot:r}of e.o.values())try{r(t,{signal:e,I:n})}catch(e){s(e)}for(const n of e.A)n.resolve(t);e.A.clear(),n()})})}function Br(e,t,n){const r=Tr++;return jr(()=>{!function(e,t,n,r){if(!e.s)if(r){if(!r.s){const o=()=>{jr(()=>{e.o.delete(t);const n=Pr.get(r);n&&w(n,o)})};e.o.set(t,{I:t,slot:n,F:o}),Dr(r,o)}}else e.o.set(t,{I:t,slot:n,F:()=>e.o.delete(t)})}(e,r,t,n)}),r}var Or=class extends En{constructor(){super(),this.L=!1,this.o=new Map,this.A=new Set,this.P=!1}detach(e){jr(()=>{const t=this.o.get(e);t&&t.F()})}value(e){return this.promise(!0,e)}next(e){return this.promise(!1,e)}promise(e,t){const n=function(){let e,t;return new Ar(new ur(function(n,r){e=n,t=r}),e,t)}();return jr(()=>{if(this.s)n.reject(new Ir("Signal initially disposed"));else if(t&&t.s)n.reject(new Ir("Owner initially disposed"));else if(e&&this.L&&this.P)n.resolve(this.ea);else if(this.A.add(n),pr(n.promise,()=>{this.A.delete(n)}),t){const e=()=>{n.reject(new Ir("Owner asynchronously disposed"))};pr(n.promise,()=>{const n=Pr.get(t);n&&w(n,e)}),Dr(t,e)}}),n.promise}G(){super.G(),jr(()=>{for(const{F:e}of this.o.values())e();this.o.clear();for(const e of this.A)e.reject(new Ir("Signal asynchronously disposed"));this.A.clear()})}};const _r=[];let Mr=!1;function jr(e){_r.push(e),async function(){if(!Mr)try{Mr=!0;let e=Ur(0);for(;e<_r.length;)await Promise.resolve(),e=Ur(e)}catch(e){s(e)}finally{_r.length=0,Mr=!1}}()}function Ur(e){const t=e+100;for(;e<t&&e<_r.length;)try{_r[e++]()}catch(e){s(e)}return e}function Dr(e,t){if(e.s)t();else{var n=Pr.get(e);if(n)n.push(t);else{const n=[t];Pr.set(e,n),In(e,()=>{for(const e of[...n])e();Pr.delete(e)})}}}function Lr(e){return{content:dt(e=tt(new Gn,1,Jn,e))}}const Rr=new kr;function Fr(e,t){const n=Rr.signal();return{channel:Vn(e,e=>{const r=t(e.data);Nr(Rr,n,{content:r,ka:e})}),signal:n}}let zr;var $r=class extends ut{},Gr=class extends ut{},Hr=class extends ut{h(){return lt(this,$r,2,Jr)}g(){return Ye(this,$r,2,Jr)}j(){return lt(this,Gr,3,Jr)}l(){return Ye(this,Gr,3,Jr)}},Jr=[2,3],Yr=gt(class extends ut{}),Wr=gt(class extends ut{}),Kr=[1,2];async function Vr(e,t){var n=Zr;let r;return t=tt(new zn,9,$n,t),e=await n(e,Lr(t)),null==(r=lt(Hn(e.data.content),mn,2,Jn))?void 0:lt(r,hn,9,yn)}async function qr(e,t){var n=Zr;t=tt(new zn,8,$n,t),await n(e,Lr(t))}async function Xr(e,t){var n=Zr;t=tt(new zn,15,$n,t),await n(e,Lr(t))}async function Zr(e,t){let n;(e=await e.channel.C(t))||Zt(It,`Falsy response received from the message channel. ${JSON.stringify(e)}`),(t=e.data)||Zt(It,`Data field in the response from the message channel is falsy. ${JSON.stringify(t)}`),(t=t.content)||Zt(It,`Content field in the response from the message channel is falsy. ${JSON.stringify(t)}`);try{n=Hn(t)}catch(e){Zt(It,`The ControlMessage can't be deserialized. ${JSON.stringify(t)}. ${JSON.stringify(e)}`)}if((t=lt(n,mn,2,Jn))||Zt(It,`MeetToAddonMessage field on ControlMessage is falsy. ${JSON.stringify(t)}`),void 0!==(null==(t=null==t?void 0:lt(t,xt,10,yn))?void 0:ct(t,1)))throw new Et(function(e){switch(e){case 0:default:return It;case 1:return Bt;case 2:return Ot;case 3:return Rt;case 4:return Ft;case 5:return $t;case 6:return Nt;case 7:return Gt;case 8:return Ht;case 9:return Jt;case 10:return Wt;case 11:return Kt;case 12:return Vt;case 13:return qt;case 14:return zt;case 15:return Xt}}(ct(t,1)));return e}async function Qr(e){const t=function(){var e=new On,t=new Bn;return tt(e,1,_n,t)}(),{channel:n,response:r}=await async function(e,t){var n,r=Zr;return t=tt(new zn,1,$n,t),e=(r=await r(e,Lr(t))).data.messagePort,n=null!=(r=null==(n=lt(Hn(r.data.content),mn,2,Jn))?void 0:lt(n,bt,1,yn))?r:Ke(n=new bt,1,we(0),0),{channel:e?Fr(e,e=>Wr(e)):void 0,response:n}}(e,t);if(!n)throw new Et(function(e){let t;var n=null!=(t=ct(e,1))?t:0;switch(e=function(e){switch(e){case 2:return"co";case 3:return"gd";default:return"unknown"}}(Ve(e,St)),n){case 1:return{errorType:"InternalError",message:`Could not connect to ${e} channel. Meet did not respond with a MessagePort.`,i:"No further information is available."};case 2:return{errorType:"InternalError",message:`Could not connect to ${e}. A conflicting ${e} exists.`,i:"No further information is available."};case 3:return{errorType:"InternalError",message:`Could not connect to ${e} channel. The addon does not have permission to open a ${e}.`,i:"This method might require EAP enrollment."};case 4:return{errorType:"InternalError",message:`Could not connect to ${e} channel. The addon is not authorized for this ${e}.`,i:"No further information is available."};case 0:default:return(e=>({errorType:"InternalError",message:`Could not connect to ${e} channel. Unknown error`,i:"No further information is available."}))(e);case 5:return"co"===e?{errorType:"InternalError",message:`Could not connect to ${e} channel. The coActivity was not found.`,i:`Consider starting the ${e} only after after the startActivity promise returns.`}:{errorType:"InternalError",message:`Could not connect to ${e} channel.`,i:"No further information is available."}}}(r));return n}async function eo(e,t,n){var r=Zr,o=new zn;t=Ke(new Un,1,we(t),0),n=Ke(t,2,Ee(n),""),o=tt(o,7,$n,n),await r(e,Lr(o))}class to extends En{constructor(e,t,n){super(),this.U=e,this.channel=t,this.h=function(e){var t=new vt(100),n=Promise.resolve();return(...r)=>yt(t)?e(...r):n}(async()=>{var e=this.channel,t=e.C,n=new zn,r=new Dn;n=tt(n,13,$n,r),await t.call(e,Lr(n))}),e=function(){var e=zr||(zr=pt("[1,2,0]"));const t=(e=He(e=Fe(e),4,Ee("dev-706864954"))).m,n=t[U];return 2&n?e:new e.constructor(Re(t,n,!0))}(),st(e,4),ve(ze(e,1)),ve(ze(e,2)),ve(ze(e,3)),n=function(e,t){return tt(e,2,$n,t)}(new zn,function(e,t){return Ke(e,3,Ee(t),"")}(function(e){return et(new Mn,2,e)}(e),n)),this.channel.send(Lr(n)),Br(this.U,async e=>{16===Ve(e.content,yn)&&await async function(e){await e.h()}(this)})}}let no;var ro=class{constructor(e){var t=no;this.h=e,this.g=t}delete(){throw Error("Not implemented.")}},oo=class extends ut{h(){return lt(this,$r,2,io)}g(){return Ye(this,$r,2,io)}j(){return lt(this,Gr,3,io)}l(){return Ye(this,Gr,3,io)}},io=[2,3],ao=class extends ut{},so=class extends ut{},co=class extends ut{},lo=class extends ut{h(){return lt(this,$r,2,uo)}g(){return Ye(this,$r,2,uo)}j(){return lt(this,Gr,3,uo)}l(){return Ye(this,Gr,3,uo)}},uo=[2,3],fo=[5,6],go=class extends ut{},ho=class extends ut{},po=[1,2,3],mo=class extends Error{constructor(){super("Failed to create CoActivity: Connection refused - Meet refused to begin Live Sharing")}},yo=class{constructor(e){this.config=e}start(){return null!=this.g||(this.g=setInterval(()=>{this.config.ha()},this.config.da)),this}shutdown(){clearInterval(this.g)}};function wo(){const e=new Map,t={set:(n,r)=>(e.set(n,r),t),D:()=>e};return t}function vo(e){if(e.g()){var t=(e=e.h().m)[U],n=Ge(e,t,1),r=Y(n,!0);if(null!=r&&r!==n&&Je(e,t,1,r),t=null==(e=r)?A():e,e=Uint8Array,k(I),null!=(n=t.g)&&!E(n))if("string"==typeof n){b.test(n)&&(n=n.replace(b,x)),n=atob(n),r=new Uint8Array(n.length);for(let e=0;e<n.length;e++)r[e]=n.charCodeAt(e);n=r}else n=null;return{bytes:new e((t=null==n?n:t.g=n)||0)}}}function bo(e,t){return t=xo(t),tt(e,2,uo,t),e}function So(e,t){return t=xo(t),tt(e,2,io,t),e}function xo(e){return Ke(new $r,1,Y(e.bytes,!1),A())}function Eo(e){if(e.l()){var t,n,r=st(e=e.j(),1),o=null!=(n=null==(t=Qe(e,mt,2))?void 0:at(t))?n:0;let i=(n=e.m)[U];const a=Ge(n,i,4);return null!=(t=null==a||"number"==typeof a?a:"NaN"===a||"Infinity"===a||"-Infinity"===a?Number(a):void 0)&&t!==a&&Je(n,i,4,t),{mediaId:r,mediaPlayoutPosition:o,mediaPlayoutRate:it(t,0),playbackState:To.get(ct(e,3))}}}function Io(e,t){return t=No(t),tt(e,3,uo,t),e}function Ao(e,t){return t=No(t),tt(e,3,io,t),e}const To=wo().set(0,"INVALID").set(1,"BUFFERING").set(2,"PLAY").set(3,"PAUSE").set(4,"ENDED").D(),Po=wo().set("INVALID",0).set("BUFFERING",1).set("PLAY",2).set("PAUSE",3).set("ENDED",4).D();function No(e){var t=new Gr;t=Ke(t,1,Ee(e.mediaId),"");var n=e.mediaPlayoutRate;if(null!=n&&"number"!=typeof n)throw Error(`Value of float/double field must be a number, found ${typeof n}: ${n}`);return t=Ke(t,4,n,0),n=Ke(n=new mt,1,be(e.mediaPlayoutPosition),"0"),Ke(t=et(t,2,n),3,we(e=Po.get(e.playbackState)),0)}function ko(e,t){return t=Ke(new so,1,we(t.u),0),tt(e,6,fo,t),e}function Co(e){var t=new ao;return tt(e,5,fo,t),e}const Bo=wo().set("co-doing",1).set("co-watching",2).D();async function Oo(e,t,n){var r=t.C,o=new ho,i=new go;let a;if(i=Ke(i,1,Ee(e.activityTitle),""),i=Ke(i,2,we(Bo.get(e.K)),0),o=tt(o,3,po,i),null!=(a=it(pe(ze(r=await r.call(t,o,Yr),1)),!1))&&a)return new jo(e,t,n,Qe(r,Hr,2));throw new mo}function _o(e,t){const n=e.config.N(t);n&&!e.config.M(e.g,n)&&(e.g=n,e.j=at(t),e.v(e.g))}function Mo(e,t){const{state:n,fa:r,context:o}=t(e.g);e.g=n,e.notify(e.g,o,r)}class jo{constructor(e,t,n,r){this.l=e,this.h=t,this.config=n,this.v=function(e){var t=new vt(500);let n,r=0;return(...o)=>{yt(t)?e(...o):(n=()=>{e(...o)},r||(r=setTimeout(()=>{let e;r=0,null==(e=n)||e()},function(e){const t=e.g;return(e=wt(e,e.index))>=t?0:t-e}(t))))}}(e=>{this.l.O(e)}),function(e,t){const n=Br(e.signal,e=>{t(e)});e.o.push(n)}(this.h,e=>{const t=Ve(e,Kr);switch(t){case 1:_o(this,lt(e,Hr,1,Kr));break;case 2:case 0:console.warn(`IllegalMessage: ${t} - Unhandled message - Please raise a bug with the MeetJS team`)}}),this.B=new yo({da:1e3,ha:()=>{var e,t,n=null==(t=(e=this.l).ja)?void 0:t.call(e);if(null!==this.g){this.g={...this.g,...n},e=new ho,n=(t=this.config).W;var r=new oo;r=Ke(r,1,be(this.j),"0"),t=n.call(t,r,this.g),e=tt(e,1,po,t),this.h.send(e)}}}).start(),this.g=null,this.j=0,r&&_o(this,r)}disconnect(){this.h.shutdown(),this.B.shutdown()}notify(e,t,n){var r=n?function({activityTitle:e}){return He(new co,4,Ee(e))}(n):void 0,o=(n=this.config).X,i=new lo;r=et(i=Ke(i,1,be(this.j),"0"),4,r),e=o.call(n,r,e),e=this.config.V(e,t),n=(t=this.h).send,e=tt(o=new ho,2,po,e),n.call(t,e)}}var Uo=class{constructor(e){this.g=e}broadcastStateUpdate(e){Mo(this.g,()=>({state:e,context:{}}))}disconnect(){this.g.disconnect()}};function Do(e,t){return null!=e&&null!=t&&e.bytes.length===t.bytes.length&&e.bytes.every((e,n)=>e===t.bytes[n])}var Lo=class{constructor(e){this.g=e}notifySwitchedToMedia(e,t,n){Mo(this.g,()=>({state:{mediaId:t,mediaPlayoutRate:1,mediaPlayoutPosition:n,playbackState:"PLAY"},fa:{activityTitle:e},context:{u:1}}))}notifyPauseState(e,t){Mo(this.g,n=>{if(null==n)throw Error("Invalid before coWatchingState");return{state:{...n,playbackState:e?"PAUSE":"PLAY",mediaPlayoutPosition:t},context:{u:3}}})}notifySeekToTimestamp(e){Mo(this.g,t=>{if(null==t)throw Error("Invalid before coWatchingState");return{state:{...t,mediaPlayoutPosition:e},context:{u:2}}})}notifyPlayoutRate(e){Mo(this.g,t=>{if(null==t)throw Error("Invalid before coWatchingState");return{state:{...t,mediaPlayoutRate:e},context:{u:4}}})}notifyBuffering(e){Mo(this.g,t=>{if(null==t)throw Error("Invalid before coWatchingState");return{state:{...t,mediaPlayoutPosition:e,playbackState:"BUFFERING"},context:{u:3}}})}notifyReady(e){Mo(this.g,t=>{if(null==t)throw Error("Invalid before coWatchingState");return{state:{...t,mediaPlayoutPosition:e},context:{u:3}}})}disconnect(){this.g.disconnect()}};function Ro(e,t){if(null==e||null==t)return!1;const n="PLAY"===e.playbackState?3*Math.max(e.mediaPlayoutRate,1):0,r=Math.abs(e.mediaPlayoutPosition-t.mediaPlayoutPosition);return e.mediaId===t.mediaId&&e.mediaPlayoutRate===t.mediaPlayoutRate&&r<=n&&e.playbackState===t.playbackState}var Fo=class{constructor(e,t){this.channel=e,this.signal=t,this.o=[]}send(e){this.channel.send(dt(e))}async C(e,t){return t((e=await this.channel.C(dt(e))).data)}shutdown(){this.o.forEach(e=>{this.signal.detach(e)})}};async function zo(e){const t=new kr,n=t.signal();!function(e,t,n,r=e=>e){Br(n,n=>{Nr(e,t,r(n))},e)}(t,n,(e=await e).signal,e=>e.content);const{ia:r,ga:o}=function(e,t){var n=$o;const r=e.signal(),o=e.signal();return Br(t,t=>{const i=n(t)?r:o;Nr(e,i,t)},e),{ia:r,ga:o}}(t,n);return{Z:new Fo(e.channel,r),aa:new Fo(e.channel,o)}}function $o(e){if(1!==Ve(e,Kr))throw Error("CA Message arrived with no known content message set");return(e=lt(e,Hr,1,Kr)).g()}var Go=class extends Pn{async notifySidePanel(e){await eo(this.context.g,1,e)}async unloadSidePanel(){await async function(e){var t=Zr,n=new zn,r=new Fn;n=tt(n,5,$n,r),await t(e,Lr(n))}(this.context.g)}async loadSidePanel(){await async function(e){var t=Zr,n=new zn,r=new jn;n=tt(n,6,$n,r),await t(e,Lr(n))}(this.context.g)}},Ho=class extends Pn{async setAddonStartingState(e){if(null===e)throw new Et(Dt("addonStartingState"));if("object"!=typeof e)throw new Et(Lt("addonStartingState",typeof e,"object | undefined"));if(void 0!==e.sidePanelUrl&&"string"!=typeof e.sidePanelUrl)throw new Et(Lt("sidePanelUrl",typeof e.sidePanelUrl,"string | undefined"));if(void 0!==e.additionalData&&"string"!=typeof e.additionalData)throw new Et(Lt("additionalData",typeof e.additionalData,"string | undefined"));if(Object.keys(e).length!==+!!e.sidePanelUrl+ +!!e.additionalData)throw new Et(Ut);if(0===Object.keys(e).length)throw new Et(jt);var t=[];t.push(nn(tn(en(1),e.sidePanelUrl),e.additionalData)),e=this.context.g;var n=new Rn,r=n.setAddonStartingState;t=nt(new Ln,t),await async function(e,t){var n=Zr;t=tt(new zn,16,$n,t),await n(e,Lr(t))}(e,r.call(n,t))}},Jo=class extends Pn{async notifyMainStage(e){await eo(this.context.g,2,e)}},Yo=class{constructor(e){e=e.cloudProjectNumber;const t=kn();if(t.cloudProjectNumber!==e)throw new Et(Ct);const n=t.S,r=t.ba;let o;no=null!=(o=no)?o:function(e,t,n){const r=new kr,o=r.signal();return e=(({destination:e,origin:t,ra:n,Y:r="ZNWN1d",onMessage:o})=>{if("*"===t)throw Error("Sending to wildcard origin not allowed.");const i=Kn(o);return e.postMessage(n?{n:r,t:n}:r,t,[i.port2]),Vn(i.port1,o)})({destination:window.parent,origin:t,Y:e,onMessage:e=>{const t=Hn(e.data.content);2===Ve(t,Jn)&&Nr(r,o,{content:lt(t,mn,2,Jn),ka:e,messagePort:e.data.messagePort})}}),new to(o,e,n)}(r,n,e),this.g=new ro(t)}async createMainStageClient(){var e=this.g;if(2!==e.h.frameType)throw new Et(Tt);return await Promise.resolve(new Go(e))}async createSidePanelClient(){var e=this.g;if(1!==e.h.frameType)throw new Et(Pt);return await Promise.resolve(new Jo(e))}async createCoWatchingClient(e){return await async function(e,t){if(({aa:e}=await zo(Qr(e.g))),t=await async function(e,t){if(t)return e=await Oo({activityTitle:t.activityTitle,K:"co-watching",ja:()=>t.onCoWatchingStateQuery(),O:e=>{t.onCoWatchingStateChanged(e)}},e,{X:Io,W:Ao,V:ko,N:Eo,M:Ro}),new Lo(e)}(e,t),!t)throw Error("Failed to create co-watching session");return t}(this.g,e)}async createCoDoingClient(e){return await async function(e,t){if(({Z:e}=await zo(Qr(e.g))),t=await async function(e,t){if(t)return e=await Oo({activityTitle:t.activityTitle,K:"co-doing",O:e=>{t.onCoDoingStateChanged(e)}},e,{X:bo,W:So,V:Co,N:vo,M:Do}),new Uo(e)}(e,t),!t)throw Error("Failed to create co-doing session");return t}(this.g,e)}async createRoomsStandaloneClient(){var e=this.g;if(2!==e.h.frameType)throw new Et(Tt);return await Promise.resolve(new Ho(e))}};let Wo=null;var Ko,Vo={addon:{getFrameType:function(){e:{var e=kn().frameType;switch(e){case 2:e="MAIN_STAGE";break e;case 1:e="SIDE_PANEL";break e;default:throw Error(`Unknown frame type: ${e}`)}}return e},createAddonSession:async function(e){if(null===e)throw new Et(Dt("config"));if("object"!=typeof e)throw new Et(Lt("config",typeof e,"object"));if("string"!=typeof e.cloudProjectNumber)throw new Et(Lt("cloudProjectNumber",typeof e.cloudProjectNumber,"string"));if(Wo&&"integration.test.google.com"!==kn().S)throw new Et(Yt);return Wo=new Yo(e)}}},qo=["meet"],Xo=o;qo[0]in Xo||void 0===Xo.execScript||Xo.execScript("var "+qo[0]);for(;qo.length&&(Ko=qo.shift());)qo.length||void 0===Vo?Xo=Xo[Ko]&&Xo[Ko]!==Object.prototype[Ko]?Xo[Ko]:Xo[Ko]={}:Xo[Ko]=Vo}).apply(n);const r=n.meet,o="RemotePC_Auth_v1",i=36e5;let a=null;function s(e){e?(document.documentElement.style.overflow="hidden",document.body.style.overflow="hidden"):(document.documentElement.style.overflow="",document.body.style.overflow="")}function c(e="silent"){const t=function(){if(a)return a.expiresAt>Date.now()?a:(a=null,localStorage.removeItem(o),null);const e=localStorage.getItem(o);if(!e)return null;try{const t=JSON.parse(e);return t.expiresAt&&t.expiresAt>Date.now()?(a=t,t):(localStorage.removeItem(o),null)}catch(e){return localStorage.removeItem(o),null}}();return t?Promise.resolve(t.username):"prompt"!==e?Promise.reject(new Error("No cached credentials")):new Promise((e,t)=>{const n=function(){let e=document.getElementById("rpc-login-modal");return e||(e=document.createElement("div"),e.id="rpc-login-modal",e.setAttribute("role","dialog"),e.setAttribute("aria-modal","true"),e.style.position="fixed",e.style.inset="0",e.style.zIndex="99999",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",e.style.background="rgba(0,0,0,0.36)",e.style.backdropFilter="blur(2px)",e.style.padding="20px",e.innerHTML='\n   <!DOCTYPE html>\n    <html lang="en">\n    <head>\n        <meta charset="UTF-8">\n        <meta name="viewport" content="width=device-width, initial-scale=1.0">\n        <title>RemotePC Login</title>\n        <style>\n          :root {\n            --rpc-bg: #ffffff;\n            --rpc-muted: #5f6368;\n            --rpc-primary: #1a73e8;\n            --rpc-radius: 12px;\n            --rpc-shadow: 0 12px 40px rgba(13, 37, 63, 0.18);\n            --rpc-gap: 12px;\n            --rpc-input-border: #e6e6e6;\n          }\n\n          body {\n            display: grid;\n            place-items: center;\n            min-height: 100vh;\n            margin: 0;\n            background-color: #f0f2f5;\n          }\n\n          #rpc-login-card, #rpc-login-card * { box-sizing: border-box; }\n\n          #rpc-login-card {\n            width: 460px;\n            max-width: calc(100vw - 32px);\n            border-radius: var(--rpc-radius);\n            background: var(--rpc-bg);\n            box-shadow: var(--rpc-shadow);\n            padding: 24px;\n            font-family: "Google Sans", Roboto, Arial, sans-serif;\n            animation: rpc-zoom-in .18s cubic-bezier(.2,.9,.3,1);\n            transform-origin: center;\n            display: flex;\n            flex-direction: column;\n            gap: 10px;\n          }\n          @keyframes rpc-zoom-in { from { transform: translateY(8px) scale(.98); opacity:0 } to { transform: translateY(0) scale(1); opacity:1 } }\n\n          .rpc-header {\n            display:flex;\n            gap: 12px;\n            align-items:center;\n            margin-bottom: 4px;\n          }\n          .rpc-logo {\n            width:56px;\n            height:56px;\n            border-radius:10px;\n            object-fit:contain;\n            background:#f7f7f7;\n            flex:0 0 56px;\n          }\n          .rpc-title { font-size:18px; color:#202124; font-weight:600; }\n          .rpc-sub { font-size:13px; color:var(--rpc-muted); margin-top:4px; }\n\n          .rpc-form {\n            margin-top: 8px;\n            display:flex;\n            flex-direction:column;\n            gap:12px;\n            max-height: calc(100vh - 180px);\n            overflow:auto;\n            padding-right: 6px;\n          }\n\n          .rpc-field { display:flex; flex-direction:column; gap:6px; }\n          .rpc-label { font-size:13px; color:var(--rpc-muted); margin-left:4px; }\n\n          .rpc-input {\n            width:100%;\n            padding: 12px 44px 12px 12px;\n            font-size:14px;\n            border-radius:8px;\n            border:1px solid #9aa0a6;\n            background:#fff;\n            outline:none;\n            transition: box-shadow .12s ease, border-color .12s ease;\n          }\n          .rpc-input:focus {\n            box-shadow: 0 8px 26px rgba(26,115,232,0.12);\n            border-color: rgba(26,115,232,0.9);\n          }\n\n          /* --- CORRECTION --- */\n          /* This new wrapper div now acts as the positioning container. */\n          .rpc-password-wrapper {\n            position: relative;\n          }\n\n          .rpc-password-toggle {\n            position: absolute;\n            right: 8px;\n            top: 50%;\n            transform: translateY(-50%);\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            min-width: 36px;\n            padding: 4px 6px;\n            border-radius: 8px;\n            border: none;\n            background: transparent;\n            cursor: pointer;\n            color: var(--rpc-muted);\n            font-size: 13px;\n          }\n\n          .rpc-password-toggle svg { display:block; width:21px; height:21px; }\n\n          .rpc-aux { display:flex; justify-content:space-between; align-items:center; margin-top:4px; gap:8px; }\n          .rpc-remember { display:flex; align-items:center; gap:8px; color:var(--rpc-muted); font-size:13px; }\n          .rpc-forgot { background:transparent; border:none; color:var(--rpc-primary); font-size:13px; cursor:pointer; padding:6px; }\n\n          .rpc-actions { display:flex; justify-content:flex-end; gap:10px; margin-top:6px; align-items:center; }\n          .rpc-btn { padding:10px 14px; border-radius:10px; border:none; font-size:14px; cursor:pointer; }\n          .rpc-btn-primary { background:var(--rpc-primary); color:#fff; }\n          .rpc-btn-ghost { background:transparent; color:var(--rpc-primary); }\n\n          .rpc-error { color:#b00020; font-size:13px; margin-top:4px; }\n\n          .rpc-loading { display:inline-block; width:16px; height:16px; border-radius:50%; border:3px solid rgba(255,255,255,0.25); border-top-color:rgba(255,255,255,0.95); animation:rpc-spin .9s linear infinite; }\n          @keyframes rpc-spin { to { transform: rotate(360deg) } }\n\n          @media (max-width:480px) {\n            #rpc-login-card { width:100%; padding:16px; }\n            .rpc-logo { width:48px; height:48px; flex:0 0 48px; }\n          }\n        </style>\n    </head>\n    <body>\n\n    <div id="rpc-login-card" role="document" aria-labelledby="rpc-title">\n      <div class="rpc-header">\n        <img src="./logo.png" class="rpc-logo" alt="RemotePC"/>\n        <div>\n          <div id="rpc-title" class="rpc-title">RemotePC</div>\n          <div class="rpc-sub">Sign in to start or join a session</div>\n        </div>\n      </div>\n\n      <form id="rpc-form" class="rpc-form" autocomplete="on" novalidate>\n        <div class="rpc-field">\n          <label class="rpc-label" for="rpc-login-username">Username</label>\n          <input id="rpc-login-username" class="rpc-input" name="username" autocomplete="username" />\n        </div>\n\n        \x3c!-- --- CORRECTION --- --\x3e\n        \x3c!-- The outer div is just for flex layout now. --\x3e\n        <div class="rpc-field">\n          <label class="rpc-label" for="rpc-login-password">Password</label>\n          \x3c!-- This new wrapper contains the input and button. --\x3e\n          <div class="rpc-password-wrapper">\n            <input id="rpc-login-password" class="rpc-input" name="password" type="password" autocomplete="current-password" />\n            <button id="rpc-password-toggle" type="button" class="rpc-password-toggle" aria-pressed="false" title="Show password">\n              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true">\n                <path d="M12 5c-7 0-10 7-10 7s3 7 10 7 10-7 10-7-3-7-10-7z" stroke="#5f6368" stroke-width="1.2" fill="none"></path>\n                <circle cx="12" cy="12" r="3" stroke="#5f6368" stroke-width="1.2" fill="none"></circle>\n              </svg>\n            </button>\n          </div>\n        </div>\n\n        <div class="rpc-aux">\n          <label class="rpc-remember"><input id="rpc-remember" type="checkbox" /> Remember me</label>\n          <button id="rpc-forgot" type="button" class="rpc-forgot">Forgot?</button>\n        </div>\n\n        <div id="rpc-error" class="rpc-error" role="alert" aria-live="assertive" style="display:none"></div>\n\n        <div class="rpc-actions">\n          <button id="rpc-cancel" type="button" class="rpc-btn">Cancel</button>\n          <button id="rpc-submit" type="submit" class="rpc-btn rpc-btn-primary">Sign in</button>\n        </div>\n      </form>\n    </div>\n\n    </body>\n    </html>\n  ',document.body.appendChild(e),e)}();n.style.display="flex",s(!0);const r=document.getElementById("rpc-form"),c=document.getElementById("rpc-login-username"),l=document.getElementById("rpc-login-password"),d=document.getElementById("rpc-submit"),u=document.getElementById("rpc-cancel"),f=document.getElementById("rpc-error"),g=document.getElementById("rpc-password-toggle"),h=document.getElementById("rpc-remember"),p=document.getElementById("rpc-forgot");f.style.display="none",f.textContent="",c.value="",l.value="",c.focus();let m=!1;const y=function(e){const t='a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])',n=e.querySelector(t),r=Array.from(e.querySelectorAll(t));let o=r[r.length-1],i=function(e){"Tab"===e.key&&(0!==r.length?e.shiftKey?document.activeElement===n&&(e.preventDefault(),o.focus()):document.activeElement===o&&(e.preventDefault(),n.focus()):e.preventDefault())};return document.addEventListener("keydown",i),()=>document.removeEventListener("keydown",i)}(n);function w(){m||(m=!0,s(!1),n.style.display="none",r.removeEventListener("submit",I),u.removeEventListener("click",x),g.removeEventListener("click",b),p.removeEventListener("click",S),document.removeEventListener("keydown",E),y())}function v(e){d.disabled=e,u.disabled=e,d.innerHTML=e?'<span class="rpc-loading" aria-hidden="true"></span>':"Sign in"}function b(e){const t="text"===l.type;l.type=t?"password":"text",g.setAttribute("aria-pressed",String(!t)),l.focus()}function S(e){e.preventDefault(),window.open("https://app.remotepc.com/rpcnew/forgotPassword","_blank")}function x(e){e&&e.preventDefault(),w(),t(new Error("User cancelled login"))}function E(e){"Escape"===e.key&&x()}async function I(t){t&&t.preventDefault(),f.style.display="none";const n=c.value.trim(),r=l.value;if(!n||!r)return f.textContent="Please enter username and password",void(f.style.display="block");v(!0);try{await new Promise(e=>setTimeout(e,650));const t=function(){const e=new Uint8Array(16);return crypto.getRandomValues(e),Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("")}(),r=h.checked?24*i:i;!function({username:e,token:t,expiresAt:n}){const r={username:e,token:t,expiresAt:n};localStorage.setItem(o,JSON.stringify(r)),a=r}({username:n,token:t,expiresAt:Date.now()+r}),w(),e(n)}catch(e){console.error("Login failed",e),f.textContent=e.message||"Sign-in failed",f.style.display="block",v(!1)}}r.addEventListener("submit",I),u.addEventListener("click",x),g.addEventListener("click",b),p.addEventListener("click",S),document.addEventListener("keydown",E)})}async function l(){const e=await r.addon.createAddonSession({cloudProjectNumber:"792791698521"}),t=await e.createSidePanelClient(),n=await t.getActivityStartingState().catch(()=>({})),i=Boolean(n.additionalData);let s=null;if(n&&"string"==typeof n.additionalData&&n.additionalData.trim())try{s=JSON.parse(n.additionalData)}catch(e){s={initiator:n.additionalData}}const l=s&&s.initiator,d=s&&s.clientId,u="https://web1.remotepc.com/rpcnew/api/ota/v3/generate",f={signInBtn:document.getElementById("signInBtn"),signOutBtn:document.getElementById("signOutBtn"),startActivityBtn:document.getElementById("startActivityBtn"),createSessionBtn:document.getElementById("createSessionBtn"),hostMsg:document.getElementById("hostMsg"),downloadBtn:document.getElementById("downloadBtn"),participantMsg:document.getElementById("participantMsg"),warnMsg:document.getElementById("warnMsg")};function g(){Object.values(f).forEach(e=>{e&&e.classList.add("hidden")})}function h(e){let t=document.getElementById("rpc-session-card");if(t){const n=document.getElementById("rpc-session-value");n&&(n.innerText=e,n.title=e),t.classList.remove("hidden")}else{t=document.createElement("div"),t.id="rpc-session-card",t.style.marginTop="12px",t.style.display="flex",t.style.flexDirection="column",t.style.alignItems="center",t.style.gap="6px",t.innerHTML=`\n      <div id="rpc-session-row" style="\n        display:flex;\n        align-items:center;\n        gap:10px;\n        width:100%;\n        justify-content:center;\n      ">\n        <div style="font-weight:600; color:#202124; white-space:nowrap;">Session ID:</div>\n        <div id="rpc-session-value" style="\n          font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, 'Roboto Mono', monospace;\n          font-size:14px;\n          padding:8px 12px;\n          border-radius:8px;\n          background:#f1f3f4;\n          color:#202124;\n          user-select:text;\n          max-width:220px;\n          overflow:hidden;\n          text-overflow:ellipsis;\n          white-space:nowrap;\n          text-align:center;\n        " title="${e}">${e}</div>\n\n        <button id="rpc-copy-session" aria-label="Copy session id" title="Copy session ID" style="\n          display:inline-flex;\n          align-items:center;\n          justify-content:center;\n          padding:8px;\n          border-radius:8px;\n          border:1px solid rgba(0,0,0,0.08);\n          background:#fff;\n          cursor:pointer;\n          min-width:44px;\n          height:40px;\n          flex:0 0 44px;\n        ">\n          <span id="rpc-copy-icon" style="display:inline-block;">\n            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true">\n              <path d="M16 1H4c-1.1 0-2 .9-2 2v12h2V3h12V1z" fill="#5f6368"/>\n              <path d="M20 5H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h12v14z" fill="#5f6368"/>\n            </svg>\n          </span>\n          <span id="rpc-copy-spinner" style="display:none;">\n            <svg width="16" height="16" viewBox="0 0 24 24" aria-hidden="true">\n              <circle cx="12" cy="12" r="10" stroke="#1a73e8" stroke-width="2" stroke-opacity="0.25" fill="none"></circle>\n              <path d="M22 12a10 10 0 00-10-10" stroke="#1a73e8" stroke-width="2" stroke-linecap="round"></path>\n            </svg>\n          </span>\n          <span id="rpc-copy-check" style="display:none;">\n            <svg width="16" height="16" viewBox="0 0 24 24" aria-hidden="true">\n              <path d="M20 6L9 17l-5-5" stroke="#1a73e8" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path>\n            </svg>\n          </span>\n        </button>\n      </div>\n      <div id="rpc-session-hint" style="font-size:12px;color:#5f6368; display:none; text-align:center;"></div>\n    `;const n=document.getElementById("downloadBtn")||document.getElementById("createSessionBtn");if(n&&n.parentNode)n.parentNode.insertBefore(t,n.nextSibling);else{const e=document.querySelector(".container");e?e.appendChild(t):document.body.appendChild(t)}}const n=document.getElementById("rpc-copy-session"),r=document.getElementById("rpc-session-value"),o=document.getElementById("rpc-session-hint"),i=document.getElementById("rpc-copy-icon"),a=document.getElementById("rpc-copy-spinner"),s=document.getElementById("rpc-copy-check");if(!n||!r)return;const c=n.cloneNode(!0);n.parentNode.replaceChild(c,n),c.addEventListener("click",async e=>{e.preventDefault();const t=(r.innerText||"").trim();if(console.log("COPY: attempt ->",t),!t)return o.innerText="Nothing to copy",o.style.display="block",void setTimeout(()=>{o.style.display="none"},1200);i&&(i.style.display="none"),s&&(s.style.display="none"),a&&(a.style.display=""),c.disabled=!0;let n=!1;try{if(!navigator.clipboard||!navigator.clipboard.writeText)throw new Error("navigator.clipboard unavailable");await navigator.clipboard.writeText(t),console.info("COPY: navigator.clipboard succeeded"),n=!0}catch(e){console.warn("COPY: clipboard failed, trying fallback",e);try{const e=document.createElement("textarea");e.value=t,e.style.position="fixed",e.style.left="-9999px",document.body.appendChild(e),e.select();const r=document.execCommand("copy");document.body.removeChild(e),n=!!r,console.info("COPY: execCommand fallback result =",r)}catch(e){console.error("COPY: fallback failed",e),n=!1}}a&&(a.style.display="none"),n?(s&&(s.style.display=""),o.innerText="Copied!",o.style.display="block",console.log("COPY: success ->",t)):(i&&(i.style.display=""),o.innerText="Copy failed",o.style.display="block",console.warn("COPY: failed both methods")),setTimeout(()=>{s&&(s.style.display="none"),i&&(i.style.display=""),c.disabled=!1,o.style.display="none"},1300)})}function p(e){const t=document.getElementById("warnMsg")||f&&f.warnMsg;t?(t.innerText=e,t.classList.remove("hidden")):console.error("Warning area not found:",e)}f.createSessionBtn&&(f.createSessionBtn.onclick=()=>{window.open("https://login.remotepc.com/rpcnew/home","_blank")});let m=null;try{m=await c("silent")}catch(e){}if(!m)return console.log("Flow: Not signed in"),g(),f.signOutBtn&&f.signOutBtn.classList.add("hidden"),void(f.signInBtn&&(f.signInBtn.classList.remove("hidden"),f.signInBtn.onclick=async()=>{await c("prompt"),window.location.reload()}));g(),f.signOutBtn&&f.signOutBtn.classList.remove("hidden");const y=l||localStorage.getItem("RemotePC_Initiator"),w=d||localStorage.getItem("RemotePC_SessionClientId");function v(){f.signOutBtn&&f.signOutBtn.classList.remove("hidden"),f.startActivityBtn&&f.startActivityBtn.classList.remove("hidden"),f.startActivityBtn&&(f.startActivityBtn.onclick=()=>{(async function(e,t,n){try{g(),n.createSessionBtn&&(n.createSessionBtn.classList.remove("hidden"),n.createSessionBtn.disabled=!0,n.createSessionBtn.innerText="Creating"),n.hostMsg&&n.hostMsg.classList.remove("hidden"),console.log("HOST: creating attended session for",t);const r=await async function(e){const t=(e||`web-${Math.random().toString(36).slice(2,9)}`)+"_RPCAT",n=new URLSearchParams;n.append("os","1"),n.append("id",t),n.append("version","1.0.0"),console.log("ATTENDED: request ->",{url:u,id:t});const r=await fetch(u,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:n.toString()});if(!r.ok){const e=await r.text().catch(()=>"<no-body>");throw console.error("ATTENDED: non-OK response",r.status,e),new Error(`Attended API returned ${r.status}`)}const o=await r.json().catch(e=>{throw console.error("ATTENDED: JSON parse error",e),new Error("Invalid JSON from attended API")});return console.log("ATTENDED: API response:",o),{raw:o,usedId:t}}(t),o=r.raw;if(!o||"OK"!==o.status||!o.message)throw console.error("ATTENDED: invalid response",o),new Error("Invalid response from attended API");const i=o.message.client_id||o.message.access_token||r.usedId;console.log("HOST: got clientId =",i);const a=JSON.stringify({initiator:t,clientId:i});try{await e.startActivity({sidePanelUrl:"https://meet-addon-hosting-32017.web.app/SidePanel.html",additionalData:a})}catch(e){/single instance|already active/i.test(e.message)?console.log("HOST: activity already active  ignoring duplicate start"):console.error("HOST: startActivity failed",e)}localStorage.setItem("RemotePC_Initiator",t),localStorage.setItem("RemotePC_SessionClientId",i),n.createSessionBtn&&(n.createSessionBtn.disabled=!1,n.createSessionBtn.innerText="Create a Session"),h(i)}catch(e){console.error("Create session error:",e),p(e.message&&e.message.includes("Failed to fetch")?"Network/CORS error when calling attended API. See console.":`Failed to create session: ${e.message||"unknown"}`),g(),n.startActivityBtn&&n.startActivityBtn.classList.remove("hidden"),n.createSessionBtn&&(n.createSessionBtn.classList.remove("hidden"),n.createSessionBtn.disabled=!1,n.createSessionBtn.innerText="Create a Session"),n.hostMsg&&n.hostMsg.classList.remove("hidden")}})(t,m,f),localStorage.setItem("RemotePC_Initiator",m)})}function b(e="Are you sure?"){return new Promise(t=>{const n=document.getElementById("rpcConfirmOverlay"),r=document.getElementById("rpcConfirmMsg"),o=document.getElementById("rpcConfirmYes"),i=document.getElementById("rpcConfirmNo");if(!(n&&o&&i&&r))return t(!1);function a(e){n.classList.add("hidden"),n.setAttribute("aria-hidden","true"),o.removeEventListener("click",s),i.removeEventListener("click",c),t(e)}function s(e){e.preventDefault(),a(!0)}function c(e){e.preventDefault(),a(!1)}r.innerText=e,n.classList.remove("hidden"),n.setAttribute("aria-hidden","false"),o.addEventListener("click",s),i.addEventListener("click",c)})}console.log("sessionInitiator (payload/local):",y),console.log("sessionClientId (payload/local):",w),console.log("userEmail:",m),console.log("isSessionStarted:",i),console.log("startingState:",n),y?y===m?(console.log("Flow: Host (returning)"),v()):i?(console.log("Flow: Participant"),f.signOutBtn&&f.signOutBtn.classList.remove("hidden"),f.downloadBtn&&f.downloadBtn.classList.remove("hidden"),f.participantMsg&&f.participantMsg.classList.remove("hidden"),f.downloadBtn&&(f.downloadBtn.onclick=()=>{const e=d||localStorage.getItem("RemotePC_SessionClientId")||"",t=new URLSearchParams;e&&t.set("clientId",e);const n="https://meet-addon-hosting-32017.web.app/DownloadRedirect.html"+(t.toString()?"?"+t.toString():"");console.log("DOWNLOAD: opening",n),window.open(n,"_blank")}),w&&h(w)):(console.log("Flow: Premature non-host (warning)"),f.warnMsg&&f.warnMsg.classList.remove("hidden")):(console.log("Flow: Host (first opener)"),v()),window.__rpc_signout_currentUser=m,window.__rpc_signout_startingState=n,window.__rpc_signout_delegated_attached||(window.__rpc_signout_delegated_attached=!0,document.addEventListener("click",async function(e){if(!e.target.closest||!e.target.closest("#signOutBtn"))return;e.preventDefault();const t=window.__rpc_signout_currentUser,n=window.__rpc_signout_startingState||{};console.log("SIGNOUT: delegated start  userEmail:",t);try{const r=n&&n.additionalData,i=localStorage.getItem("RemotePC_Initiator");if(i&&i===t||r&&r===t){if(!await b("You are the session initiator. End the session and sign out?"))return void console.log("SIGNOUT: cancelled (initiator)");localStorage.removeItem("RemotePC_Initiator"),console.log("SIGNOUT: removed RemotePC_Initiator")}else if(!await b("Sign out now?"))return void console.log("SIGNOUT: cancelled (participant)");try{await async function(){console.log("AUTH: logout() called");try{localStorage.removeItem(o),a=null,console.log("AUTH: localStorage cleared")}catch(e){console.warn("AUTH: logout() cleanup error",e)}}(),console.log("SIGNOUT: logout() OK")}catch(e){console.warn("SIGNOUT: logout() threw",e)}try{sessionStorage.removeItem("meetAddonEmail")}catch(e){}if(window.google&&google.accounts&&google.accounts.id&&google.accounts.id.disableAutoSelect)try{google.accounts.id.disableAutoSelect(),console.log("SIGNOUT: disabled GSI autoSelect")}catch(e){}}catch(e){console.error("SIGNOUT: unexpected",e)}finally{console.log("SIGNOUT: reloading UI"),window.location.reload()}},{capture:!1}))}const d="792791698521-d99qe7hhcstqa58iefpuqdel87lradsd.apps.googleusercontent.com",u="meetAddonEmail";let f=null,g=!1;async function h(){const e=await r.addon.createAddonSession({cloudProjectNumber:"792791698521"}),t=await e.createMainStageClient(),n=(await t.getActivityStartingState()).additionalData;let o;try{o=await function(e="silent"){if(f)return Promise.resolve(f);const t=sessionStorage.getItem(u);return t?(f=t,Promise.resolve(t)):new Promise((t,n)=>{var r;if(r="silent"===e,g||(google.accounts.id.initialize({client_id:d,auto_select:!!r,cancel_on_tap_outside:!1,callback:e=>{try{const t=JSON.parse(atob(e.credential.split(".")[1]));f=t.email,sessionStorage.setItem(u,f)}catch(e){console.error("Failed to parse GSI credential",e)}}}),g=!0),"silent"===e)return void google.accounts.id.prompt(e=>{f?t(f):n(new Error("Silent sign-in failed"))});let o=!1;google.accounts.id.prompt(e=>{o?f?t(f):n(new Error("Prompt sign-in failed")):(o=!0,f||google.accounts.id.prompt())})})}("silent")}catch{o=null}console.log("initiator from startingState:",n),console.log("myEmail from Identity SDK:",o),document.getElementById("greeting").innerText=n===o?" Hi viewer":" Hi host"}return t})());